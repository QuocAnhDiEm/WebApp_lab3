<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Weather Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:Arial,Helvetica,sans-serif;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  min-height:100vh;
  padding:20px;
}
.container{max-width:900px;margin:0 auto}
.search-box{
  background:#fff;
  padding:20px;
  border-radius:10px;
  margin-bottom:20px;
}
.search-box input{
  width:70%;
  padding:12px;
  border:2px solid #ddd;
  border-radius:4px;
  font-size:16px;
}
.search-box button{
  width:28%;
  padding:12px;
  background:#667eea;
  color:#fff;
  border:none;
  border-radius:4px;
  cursor:pointer;
  font-size:16px;
  margin-left:2%;
}
.weather-card{
  background:#fff;
  padding:30px;
  border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
  margin-bottom:20px;
}
.current-weather{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.temp-display{font-size:60px;font-weight:bold}
.forecast-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:15px;
  margin-top:20px;
}
.forecast-item{
  background:#f8f9fa;
  padding:15px;
  border-radius:8px;
  text-align:center;
}
.loading{text-align:center;padding:40px;font-size:18px;color:#fff}
.error{
  background:#dc3545;
  color:#fff;
  padding:15px;
  border-radius:8px;
  margin-bottom:20px;
}
.recent-searches{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
}
.recent-city{
  padding:5px 15px;
  background:#e9ecef;
  border-radius:20px;
  cursor:pointer;
  font-size:14px;
}
.recent-city:hover{background:#dee2e6}
</style>
</head>
<body>
<div class="container">
  <h1 style="color:white;text-align:center;margin-bottom:30px;">Weather Dashboard</h1>
  <div class="search-box">
    <input type="text" id="cityInput" placeholder="Enter city name..."
           onkeypress="if(event.key==='Enter') searchWeather()">
    <button onclick="searchWeather()">Search</button>
    <div class="recent-searches" id="recentSearches"></div>
  </div>
  <div id="errorMessage"></div>
  <div id="weatherDisplay"></div>
  <div id="forecastDisplay"></div>
</div>

<script>
const API_KEY = 'b29b0bd15d0ec0aa7af69ec6115ad068';
const weatherDisplay = document.getElementById("weatherDisplay");
const forecastDisplay = document.getElementById("forecastDisplay");
const errorMessage = document.getElementById("errorMessage");
const recentContainer = document.getElementById("recentSearches");


function getIcon(desc){
  desc = desc.toLowerCase();
  if(desc.includes("cloud")) return "‚òÅÔ∏è";
  if(desc.includes("rain")) return "üåßÔ∏è";
  if(desc.includes("clear")) return "‚òÄÔ∏è";
  if(desc.includes("snow")) return "‚ùÑÔ∏è";
  if(desc.includes("storm")) return "‚õàÔ∏è";
  return "üå§Ô∏è";
}

async function fetchWeather(city){
  const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${API_KEY}&units=metric`;
  const res = await fetch(url);
  if(!res.ok) throw new Error("City not found");
  return res.json();
}

async function fetchForecast(city){
  const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${API_KEY}&units=metric`;
  const res = await fetch(url);
  if(!res.ok) throw new Error("Forecast not found");
  return res.json();
}

function displayWeather(data){
  const icon = getIcon(data.weather[0].main);
  weatherDisplay.innerHTML = `
  <div class="weather-card">
    <div class="current-weather">
      <div>
        <h2>${data.name}, ${data.sys.country}</h2>
        <p>${data.weather[0].description} ${icon}</p>
        <p>Humidity: ${data.main.humidity}% | Wind: ${data.wind.speed} km/h</p>
      </div>
      <div class="temp-display">${Math.round(data.main.temp)}¬∞C</div>
    </div>
  </div>`;
}

function displayForecast(data){
  
  const days = {};
  data.list.forEach(item=>{
    const date = item.dt_txt.split(" ")[0];
    const hour = item.dt_txt.split(" ")[1];
    if(hour==="12:00:00" && !days[date]) days[date]=item;
  });
  forecastDisplay.innerHTML = `<div class="weather-card"><h3>5-Day Forecast</h3>
    <div class="forecast-grid">
    ${Object.values(days).slice(0,5).map(d=>{
      const day = new Date(d.dt_txt).toLocaleDateString("en",{weekday:"short"});
      const icon = getIcon(d.weather[0].main);
      return `<div class="forecast-item">
        <h4>${day}</h4>
        <p>${icon}</p>
        <p>${Math.round(d.main.temp)}¬∞C</p>
      </div>`;
    }).join("")}
    </div></div>`;
}

async function searchWeather(){
  const city = document.getElementById("cityInput").value.trim();
  if(!city) return;
  weatherDisplay.innerHTML = '<div class="loading">Loading...</div>';
  forecastDisplay.innerHTML = "";
  clearError();
  try{
    const weatherData = await fetchWeather(city);
    const forecastData = await fetchForecast(city);
    displayWeather(weatherData);
    displayForecast(forecastData);
    saveRecentSearch(city);
  }catch(err){
    showError(err.message);
    weatherDisplay.innerHTML = "";
  }
}

function saveRecentSearch(city){
  let cities = JSON.parse(localStorage.getItem("recentCities")) || [];
  cities = [city, ...cities.filter(c=>c.toLowerCase()!==city.toLowerCase())];
  if(cities.length>5) cities=cities.slice(0,5);
  localStorage.setItem("recentCities",JSON.stringify(cities));
  loadRecentSearches();
}

function loadRecentSearches(){
  const cities = JSON.parse(localStorage.getItem("recentCities")) || [];
  recentContainer.innerHTML = cities.map(c=>`<div class="recent-city" onclick="selectCity('${c}')">${c}</div>`).join("");
}

function selectCity(city){
  document.getElementById("cityInput").value = city;
  searchWeather();
}

function showError(msg){
  errorMessage.innerHTML = `<div class="error">${msg}</div>`;
}
function clearError(){errorMessage.innerHTML="";}


loadRecentSearches();
</script>
</body>
</html>
